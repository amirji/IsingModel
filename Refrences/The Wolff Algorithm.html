<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- saved from url=(0067)http://latt.if.usp.br/technical-pages/twawesab/Text.html/node1.html -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>The Wolff Algorithm</title>
<meta name="description" content="The Wolff Algorithm">
<meta name="keywords" content="Text">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">

<meta name="Generator" content="LaTeX2HTML v2002-2-1">
<meta http-equiv="Content-Style-Type" content="text/css">

<link rel="STYLESHEET" href="http://latt.if.usp.br/technical-pages/twawesab/Text.html/Text.css">

<link rel="next" href="http://latt.if.usp.br/technical-pages/twawesab/Text.html/node2.html">
<link rel="previous" href="http://latt.if.usp.br/technical-pages/twawesab/Text.html/Text.html">
<link rel="up" href="http://latt.if.usp.br/technical-pages/twawesab/Text.html/Text.html">
<link rel="next" href="http://latt.if.usp.br/technical-pages/twawesab/Text.html/node2.html">
</head>

<body bgcolor="ffffff" gram_dict="true">

<div class="navigation"><!--Navigation Panel-->
<a name="tex2html26" href="http://latt.if.usp.br/technical-pages/twawesab/Text.html/node2.html">
<img width="37" height="24" align="BOTTOM" border="0" alt="next" src="./The Wolff Algorithm_files/next.gif"></a> 
<a name="tex2html24" href="http://latt.if.usp.br/technical-pages/twawesab/Text.html/Text.html">
<img width="26" height="24" align="BOTTOM" border="0" alt="up" src="./The Wolff Algorithm_files/up.gif"></a> 
<a name="tex2html18" href="http://latt.if.usp.br/technical-pages/twawesab/Text.html/Text.html">
<img width="63" height="24" align="BOTTOM" border="0" alt="previous" src="./The Wolff Algorithm_files/prev.gif"></a>   
<br>
<b> Next:</b> <a name="tex2html27" href="http://latt.if.usp.br/technical-pages/twawesab/Text.html/node2.html">Arbitrary External Sources</a>
<b> Up:</b> <a name="tex2html25" href="http://latt.if.usp.br/technical-pages/twawesab/Text.html/Text.html">The Wolff Algorithm with</a>
<b> Previous:</b> <a name="tex2html19" href="http://latt.if.usp.br/technical-pages/twawesab/Text.html/Text.html">The Wolff Algorithm with</a>
<br>
<br></div>
<!--End of Navigation Panel-->

<h1><a name="SECTION00010000000000000000">
The Wolff Algorithm</a>
</h1>

<p>
The traditional Metropolis algorithm, when applied do the Ising models
 close to their critical points, suffers from severe critical slowing down
 problems. This is due to its single-site updating procedure, which is
 good for updating the short-wavelength components of the configurations,
 but very bad at updating the long-wavelength components. Near the
 critical point the long-wavelength components play an important role due
 to the emergence of long-distance correlations, and in these
 circumstances the algorithm tends to diffuse only very slowly through the
 configuration space of the model. This increases the autocorrelations
 along the stochastic sequence of configurations and severely degrades the
 statistical quality of the results.

</p><p>
This is always a problem is the case of quantum field theory, since in
 that theory we are interested primarily in the critical region of the
 statistical models. If we are to use the Ising model in the analysis of
 problems in quantum field theory, we must use simulation techniques that
 do not suffer from such problems. The cluster algorithms are the answer
 to our needs, and among them the Wolff algorithm is particularly well
 suited for the task, due to its simplicity and efficiency. Cluster
 algorithms are characterized by the updating of whole sets of sites, or
 clusters, at a time, and in doing this they solve the problem of critical
 slowing down. The problem of how to make collective updates with a low
 rate of rejection and in such a way that the required statistical
 distribution is still produced correctly is a very difficult one, which
 was solved by the inventors of the cluster algorithms.

</p><p>
In this section we will describe the basic algorithm and show that it
 satisfied the condition of detailed balance, thus converging to the
 correct distribution. After that we will generalize the algorithm to the
 case in which we introduce external sources in the systems, as well as to
 the case in which we use fixed rather than the more usual periodical
 boundary conditions. This last topic will also lead us to consider the
 use of truncated clusters, a variation of the algorithm which may be
 useful under some circumstances.

</p><p>
Let us start by reviewing the fundamentals of the Metropolis algorithm.
 In order to do that we must first establish some notation. Consider a
 model in quantum field theory defined by an action functional <span class="MATH"><img width="40" height="37" align="MIDDLE" border="0" src="./The Wolff Algorithm_files/img1.gif" alt="$S[\psi]$"></span>,
 where <span class="MATH"><img width="17" height="35" align="MIDDLE" border="0" src="./The Wolff Algorithm_files/img2.gif" alt="$\psi$"></span> is the field. This action determines the distribution of
 probabilities for all the possible configurations <span class="MATH"><img width="19" height="16" align="BOTTOM" border="0" src="./The Wolff Algorithm_files/img3.gif" alt="$C$"></span> of the field, which
 is given by <!-- MATH
 $P_{B}[C]=Z\exp(-S[C])$
 -->
<span class="MATH"><img width="192" height="37" align="MIDDLE" border="0" src="./The Wolff Algorithm_files/img4.gif" alt="$P_{B}[C]=Z\exp(-S[C])$"></span>, where <span class="MATH"><img width="19" height="16" align="BOTTOM" border="0" src="./The Wolff Algorithm_files/img5.gif" alt="$Z$"></span> is a normalization
 constant and the dependence on the field can be represented either by
 <span class="MATH"><img width="40" height="37" align="MIDDLE" border="0" src="./The Wolff Algorithm_files/img1.gif" alt="$S[\psi]$"></span> or by <span class="MATH"><img width="42" height="37" align="MIDDLE" border="0" src="./The Wolff Algorithm_files/img6.gif" alt="$S[C]$"></span>. What a simulation algorithm does is to establish
 a probability <!-- MATH
 $W[C\rightarrow C']$
 -->
<span class="MATH"><img width="99" height="37" align="MIDDLE" border="0" src="./The Wolff Algorithm_files/img7.gif" alt="$W[C\rightarrow C&#39;]$"></span> for going from a configuration <span class="MATH"><img width="19" height="16" align="BOTTOM" border="0" src="./The Wolff Algorithm_files/img3.gif" alt="$C$"></span> to
 a configuration <span class="MATH"><img width="24" height="17" align="BOTTOM" border="0" src="./The Wolff Algorithm_files/img8.gif" alt="$C&#39;$"></span> on a single iteration of the algorithm. By iterating
 the algorithm indefinitely one produces a sequence of configurations with
 a distribution of probabilities that is supposed to approach <span class="MATH"><img width="53" height="37" align="MIDDLE" border="0" src="./The Wolff Algorithm_files/img9.gif" alt="$P_{B}[C]$"></span>.

</p><p>
In order for this to work, it suffices that the algorithm satisfy two
 conditions: ergodicity and detailed balance. Although not strictly
 necessary, these conditions are sufficient to ensure convergence to the
 correct distribution. Ergodicity means that any configuration <span class="MATH"><img width="24" height="17" align="BOTTOM" border="0" src="./The Wolff Algorithm_files/img8.gif" alt="$C&#39;$"></span> should
 be reachable from any other configuration <span class="MATH"><img width="19" height="16" align="BOTTOM" border="0" src="./The Wolff Algorithm_files/img3.gif" alt="$C$"></span> in a finite number of
 iterations of the algorithm. In other words, the algorithm should never
 get stuck in any particular configuration that it is unable to leave, and
 there should be no configuration that it cannot reach from some other
 configuration. This means that the algorithm should be able to diffuse
 through the whole space of possible configurations of the field, without
 leaving out any points or regions within it. Note that no statement is
 made here about how fast it is able to diffuse. Of course, in practice
 the quality of the algorithm will depend on it being able to do so fast,
 because the space of configurations is usually very large.

</p><p>
The condition of detailed balance is the one which will mostly concern us
 here. It is a relation between the probability <!-- MATH
 $W[C\rightarrow C']$
 -->
<span class="MATH"><img width="99" height="37" align="MIDDLE" border="0" src="./The Wolff Algorithm_files/img7.gif" alt="$W[C\rightarrow C&#39;]$"></span> of
 going from the configuration <span class="MATH"><img width="19" height="16" align="BOTTOM" border="0" src="./The Wolff Algorithm_files/img3.gif" alt="$C$"></span> to the configuration <span class="MATH"><img width="24" height="17" align="BOTTOM" border="0" src="./The Wolff Algorithm_files/img8.gif" alt="$C&#39;$"></span> and the
 probability <!-- MATH
 $W[C'\rightarrow C]$
 -->
<span class="MATH"><img width="99" height="37" align="MIDDLE" border="0" src="./The Wolff Algorithm_files/img10.gif" alt="$W[C&#39;\rightarrow C]$"></span> of doing the reversed update, that is,
 of going from <span class="MATH"><img width="24" height="17" align="BOTTOM" border="0" src="./The Wolff Algorithm_files/img8.gif" alt="$C&#39;$"></span> to <span class="MATH"><img width="19" height="16" align="BOTTOM" border="0" src="./The Wolff Algorithm_files/img3.gif" alt="$C$"></span>, and involves the probabilities <span class="MATH"><img width="44" height="37" align="MIDDLE" border="0" src="./The Wolff Algorithm_files/img11.gif" alt="$P[C]$"></span> and
 <span class="MATH"><img width="49" height="37" align="MIDDLE" border="0" src="./The Wolff Algorithm_files/img12.gif" alt="$P[C&#39;]$"></span> of the two configurations involved, within the ensemble of all
 possible configurations. It states that the ratio of these two
 probabilities should satisfy the condition

</p><p>
<br></p><p></p>
<div align="CENTER" class="mathdisplay">
<!-- MATH
 \begin{displaymath}
\frac{W[C\rightarrow C']}{W[C'\rightarrow C]}=\frac{P[C']}{P[C]}.
\end{displaymath}
 -->

<img width="174" height="52" border="0" src="./The Wolff Algorithm_files/img13.gif" alt="\begin{displaymath}
\frac{W[C\rightarrow C&#39;]}{W[C&#39;\rightarrow C]}=\frac{P[C&#39;]}{P[C]}.
\end{displaymath}">
</div>
<br clear="ALL">
<p></p>

<p>
Since the probabilities of the configurations can be written in terms of
 the action, this condition can be translated into

</p><p>
<br></p><p></p>
<div align="CENTER" class="mathdisplay">
<!-- MATH
 \begin{displaymath}
\frac{W[C\rightarrow C']}{W[C'\rightarrow C]}
=\frac{\exp(-S[C'])}{\exp(-S[C])}=\exp(-S[C']+S[C])=\exp(-\Delta S),
\end{displaymath}
 -->

<img width="526" height="52" border="0" src="./The Wolff Algorithm_files/img14.gif" alt="\begin{displaymath}
\frac{W[C\rightarrow C&#39;]}{W[C&#39;\rightarrow C]}
=\frac{\exp(-S[C&#39;])}{\exp(-S[C])}=\exp(-S[C&#39;]+S[C])=\exp(-\Delta S),
\end{displaymath}">
</div>
<br clear="ALL">
<p></p>

<p>
where <span class="MATH"><img width="33" height="16" align="BOTTOM" border="0" src="./The Wolff Algorithm_files/img15.gif" alt="$\Delta S$"></span> is the change in the action due to the update of the
 configuration. It is possible to show by elementary means, in a simple
 one-dimensional case, that this condition is sufficient to guarantee that
 the set of configurations produced by the algorithm converges to the
 correct distribution. However, that is not our focus here, and we will
 simply take it as a given fact. Let us now describe in detail the usual
 Metropolis algorithm for a single local update in the Ising model, and
 show that it satisfies this condition. Starting from some initial
 configuration, the Metropolis single-site updating algorithm is given by
 the following sequence of steps:

</p><p>

</p><ol>
<li>Choose a single site of the lattice for trying an update, for
 example in a random way.

<p>
</p></li>
<li>Calculate the variation <span class="MATH"><img width="33" height="16" align="BOTTOM" border="0" src="./The Wolff Algorithm_files/img15.gif" alt="$\Delta S$"></span> of the action caused by flipping
 the field at that site.

<p>
</p></li>
<li>If it happens that <!-- MATH
 $\Delta S\leq 0$
 -->
<span class="MATH"><img width="68" height="35" align="MIDDLE" border="0" src="./The Wolff Algorithm_files/img16.gif" alt="$\Delta S\leq 0$"></span>, then flip the field with
 probability equal to <span class="MATH"><img width="14" height="16" align="BOTTOM" border="0" src="./The Wolff Algorithm_files/img17.gif" alt="$1$"></span>.

<p>
</p></li>
<li>If <span class="MATH"><img width="67" height="35" align="MIDDLE" border="0" src="./The Wolff Algorithm_files/img18.gif" alt="$\Delta S&gt;0$"></span>, then flip the field with probability <!-- MATH
 $\exp(-\Delta
 S)$
 -->
<span class="MATH"><img width="91" height="37" align="MIDDLE" border="0" src="./The Wolff Algorithm_files/img19.gif" alt="$\exp(-\Delta
S)$"></span>, which in this case is a number in the interval <span class="MATH"><img width="46" height="37" align="MIDDLE" border="0" src="./The Wolff Algorithm_files/img20.gif" alt="$(0,1)$"></span>; if the
 update is rejected, repeat the current configuration in the stochastic
 sequence.

<p>
</p></li>
<li>Loop back to step&nbsp;<span class="MATH"><img width="14" height="16" align="BOTTOM" border="0" src="./The Wolff Algorithm_files/img17.gif" alt="$1$"></span> and repeat the procedure.

<p>
</p></li>
</ol>

<p>
As one can see, the algorithm is very simple and easily generalizable to
 more complex models. It is also possible to improve it in various rather
 technical ways, that help in some cases but that do not solve the central
 problem of critical slowing down caused by the local update. It is now
 easy to verify that this algorithm satisfies the condition of detailed
 balance. We must consider three cases, depending on whether the variation
 of the action is positive, zero or negative. If the update is such that
 <span class="MATH"><img width="67" height="35" align="MIDDLE" border="0" src="./The Wolff Algorithm_files/img18.gif" alt="$\Delta S&gt;0$"></span>, then we have for its probability <!-- MATH
 $W[C\rightarrow
 C']=\exp(-\Delta S)$
 -->
<span class="MATH"><img width="210" height="37" align="MIDDLE" border="0" src="./The Wolff Algorithm_files/img21.gif" alt="$W[C\rightarrow
C&#39;]=\exp(-\Delta S)$"></span>; in this case the reversed update is such that
 <span class="MATH"><img width="67" height="35" align="MIDDLE" border="0" src="./The Wolff Algorithm_files/img22.gif" alt="$\Delta S&lt;0$"></span>, so that we have for its probability <!-- MATH
 $W[C'\rightarrow C]=1$
 -->
<span class="MATH"><img width="133" height="37" align="MIDDLE" border="0" src="./The Wolff Algorithm_files/img23.gif" alt="$W[C&#39;\rightarrow C]=1$"></span>;
 it therefore follows that

</p><p>
<br></p><p></p>
<div align="CENTER" class="mathdisplay">
<!-- MATH
 \begin{displaymath}
\frac{W[C\rightarrow C']}{W[C'\rightarrow C]} =\frac{\exp(-\Delta
S)}{1}=\exp(-\Delta S),
\end{displaymath}
 -->

<img width="326" height="52" border="0" src="./The Wolff Algorithm_files/img24.gif" alt="\begin{displaymath}
\frac{W[C\rightarrow C&#39;]}{W[C&#39;\rightarrow C]} =\frac{\exp(-\Delta
S)}{1}=\exp(-\Delta S),
\end{displaymath}">
</div>
<br clear="ALL">
<p></p>

<p>
as required by the condition. If the update is such that <span class="MATH"><img width="67" height="35" align="MIDDLE" border="0" src="./The Wolff Algorithm_files/img22.gif" alt="$\Delta S&lt;0$"></span>,
 then the probability for the update is <!-- MATH
 $W[C\rightarrow C']=1$
 -->
<span class="MATH"><img width="133" height="37" align="MIDDLE" border="0" src="./The Wolff Algorithm_files/img25.gif" alt="$W[C\rightarrow C&#39;]=1$"></span>, and the
 probability for the reversed update is <!-- MATH
 $W[C\rightarrow
 C']=\exp(-\Delta'S)$
 -->
<span class="MATH"><img width="215" height="37" align="MIDDLE" border="0" src="./The Wolff Algorithm_files/img26.gif" alt="$W[C\rightarrow
C&#39;]=\exp(-\Delta&#39;S)$"></span>, where <!-- MATH
 $\Delta'S=-\Delta S$
 -->
<span class="MATH"><img width="105" height="37" align="MIDDLE" border="0" src="./The Wolff Algorithm_files/img27.gif" alt="$\Delta&#39;S=-\Delta S$"></span> is the variation of the
 action in the reversed update; it therefore follows that

</p><p>
<br></p><p></p>
<div align="CENTER" class="mathdisplay">
<!-- MATH
 \begin{displaymath}
\frac{W[C\rightarrow C']}{W[C'\rightarrow C]} =\frac{1}{\exp(\Delta
S)}=\exp(-\Delta S),
\end{displaymath}
 -->

<img width="312" height="52" border="0" src="./The Wolff Algorithm_files/img28.gif" alt="\begin{displaymath}
\frac{W[C\rightarrow C&#39;]}{W[C&#39;\rightarrow C]} =\frac{1}{\exp(\Delta
S)}=\exp(-\Delta S),
\end{displaymath}">
</div>
<br clear="ALL">
<p></p>

<p>

</p><div align="CENTER"><a name="lattice-periodic"></a><a name="71"></a>
<table>
<caption align="BOTTOM"><strong>Figure 1:</strong>
A periodical lattice with the sites and links classified, showing
the clusters that may be built in it.</caption>
<tbody><tr><td><img width="397" height="400" border="0" src="./The Wolff Algorithm_files/img29.gif" alt="\begin{figure}\centering
\epsfig{file=lattice-periodic.fps,scale=0.7,angle=0}
\end{figure}"></td></tr>
</tbody></table>
</div>

<p>
just as in the previous case. If <span class="MATH"><img width="67" height="16" align="BOTTOM" border="0" src="./The Wolff Algorithm_files/img30.gif" alt="$\Delta S=0$"></span>, then we also have
 <span class="MATH"><img width="72" height="17" align="BOTTOM" border="0" src="./The Wolff Algorithm_files/img31.gif" alt="$\Delta&#39;S=0$"></span>, and hence <!-- MATH
 $W[C\rightarrow C']=W[C'\rightarrow C]=1$
 -->
<span class="MATH"><img width="253" height="37" align="MIDDLE" border="0" src="./The Wolff Algorithm_files/img32.gif" alt="$W[C\rightarrow C&#39;]=W[C&#39;\rightarrow C]=1$"></span>, so
 that the ratio of the two updating probabilities is equal to <span class="MATH"><img width="14" height="16" align="BOTTOM" border="0" src="./The Wolff Algorithm_files/img17.gif" alt="$1$"></span>; since
 in this case <!-- MATH
 $\exp(-\Delta S)=\exp(0)$
 -->
<span class="MATH"><img width="168" height="37" align="MIDDLE" border="0" src="./The Wolff Algorithm_files/img33.gif" alt="$\exp(-\Delta S)=\exp(0)$"></span> is also equal to <span class="MATH"><img width="14" height="16" align="BOTTOM" border="0" src="./The Wolff Algorithm_files/img17.gif" alt="$1$"></span>, we see that
 in all three cases the condition is satisfied.

</p><p>
In order to discuss the Wolff algorithm, we must now establish a few more
 concepts and notations. The basic idea of the algorithm will be to first
 built a cluster of sites according to certain rules, and then to flip the
 whole cluster. The cluster will be built by the ``activation'' of some of
 the links between two neighboring sites, and requires that we classify
 the links according to whether it connects two sites where the field has
 the same orientation, or opposite orientations. At first, let us consider
 only lattices with periodical boundary conditions and the model in the
 absence of any external sources. Later on we will extend the algorithm to
 these other cases. We should recall here that the Ising model is defined
 by the action

</p><p>
<br></p><p></p>
<div align="CENTER" class="mathdisplay">
<!-- MATH
 \begin{displaymath}
S[\psi]=-\beta\sum_{\ell}\psi_{-}\psi_{+},
\end{displaymath}
 -->

<img width="171" height="53" border="0" src="./The Wolff Algorithm_files/img34.gif" alt="\begin{displaymath}
S[\psi]=-\beta\sum_{\ell}\psi_{-}\psi_{+},
\end{displaymath}">
</div>
<br clear="ALL">
<p></p>

<p>

</p><div align="CENTER"><a name="cluster-periodic"></a><a name="79"></a>
<table>
<caption align="BOTTOM"><strong>Figure 2:</strong>
The same periodical lattice, showing a possible cluster that
might have been built in it.</caption>
<tbody><tr><td><img width="397" height="400" border="0" src="./The Wolff Algorithm_files/img35.gif" alt="\begin{figure}\centering
\epsfig{file=cluster-periodic.fps,scale=0.7,angle=0}
\end{figure}"></td></tr>
</tbody></table>
</div>

<p>
where <!-- MATH
 $0<\beta<\infty$
 -->
<span class="MATH"><img width="95" height="35" align="MIDDLE" border="0" src="./The Wolff Algorithm_files/img36.gif" alt="$0&lt;\beta&lt;\infty$"></span> is the free parameter of the model, the sum is
 over the links and <span class="MATH"><img width="28" height="35" align="MIDDLE" border="0" src="./The Wolff Algorithm_files/img37.gif" alt="$\psi_{-}$"></span>, <span class="MATH"><img width="28" height="35" align="MIDDLE" border="0" src="./The Wolff Algorithm_files/img38.gif" alt="$\psi_{+}$"></span> are the values of the field at
 the two ends of a given link. In figure&nbsp;<a href="http://latt.if.usp.br/technical-pages/twawesab/Text.html/node1.html#lattice-periodic">1</a> one can
 see an example of a two-dimensional periodical lattice with all its sites
 and links dully classified. The sites where the field is positive are
 shown as black circles and those where the field is negative as white
 circles. The links that connect two sites with the same orientation are
 shown as solid lines, and those connecting sites with opposite
 orientations as dashed lines. Note that this is true for the border links
 as well, which establish the periodical boundary conditions. The links
 represented by solid lines will be denoted by <span class="MATH"><img width="24" height="35" align="MIDDLE" border="0" src="./The Wolff Algorithm_files/img39.gif" alt="$\ell_{+}$"></span> in the formulas,
 and those represented by dashed lines by <span class="MATH"><img width="24" height="35" align="MIDDLE" border="0" src="./The Wolff Algorithm_files/img40.gif" alt="$\ell_{-}$"></span>. According to the
 algorithm only <span class="MATH"><img width="24" height="35" align="MIDDLE" border="0" src="./The Wolff Algorithm_files/img39.gif" alt="$\ell_{+}$"></span> links can be activated to form clusters, so the
 sets of sites connected by solid lines illustrate the clusters that can
 be formed in this particular configuration. We may now state the Wolff
 algorithm, which is given by the following sequence of steps:

</p><p>

</p><div align="CENTER"><a name="large-cluster"></a><a name="90"></a>
<table>
<caption align="BOTTOM"><strong>Figure 3:</strong>
A larger lattice, showing a cluster and its
boundary.</caption>
<tbody><tr><td><img width="420" height="419" border="0" src="./The Wolff Algorithm_files/img41.gif" alt="\begin{figure}\centering
\epsfig{file=large-cluster.fps,scale=0.56,angle=0}
\end{figure}"></td></tr>
</tbody></table>
</div>

<p>

</p><ol>
<li>Choose a single site of the lattice for starting to build the
 cluster, in a random way.

<p>
</p></li>
<li>Consider all the links connected to that initial site; the
 <span class="MATH"><img width="24" height="35" align="MIDDLE" border="0" src="./The Wolff Algorithm_files/img40.gif" alt="$\ell_{-}$"></span> links are never to be activated; activate the <span class="MATH"><img width="24" height="35" align="MIDDLE" border="0" src="./The Wolff Algorithm_files/img39.gif" alt="$\ell_{+}$"></span> links
 with the probability <!-- MATH
 $p_{+}=1-\exp(-2\beta\psi_{-}\psi_{+})$
 -->
<span class="MATH"><img width="209" height="37" align="MIDDLE" border="0" src="./The Wolff Algorithm_files/img42.gif" alt="$p_{+}=1-\exp(-2\beta\psi_{-}\psi_{+})$"></span>, thus
 forming a first cluster of sites, that is, updating the cluster from a
 single site to possibly a few sites.

<p>
</p></li>
<li>Given the set of sites added to the cluster in the <em>previous</em>
 update of the cluster (which is <em>not</em> the whole cluster), consider
 all the links that connect those sites to sites that are still outside
 the cluster; among these, activate the <span class="MATH"><img width="24" height="35" align="MIDDLE" border="0" src="./The Wolff Algorithm_files/img39.gif" alt="$\ell_{+}$"></span> links with the
 probability <span class="MATH"><img width="25" height="33" align="MIDDLE" border="0" src="./The Wolff Algorithm_files/img43.gif" alt="$p_{+}$"></span>, thus enlarging (updating) the cluster.

<p>
</p></li>
<li>Loop back to step&nbsp;<span class="MATH"><img width="14" height="16" align="BOTTOM" border="0" src="./The Wolff Algorithm_files/img44.gif" alt="$3$"></span> until the set of links left for activation
 trial in the next round of the loop is empty; this means that you stop
 this loop at the first instance of step&nbsp;<span class="MATH"><img width="14" height="16" align="BOTTOM" border="0" src="./The Wolff Algorithm_files/img44.gif" alt="$3$"></span> that adds no new sites to the
 cluster.

<p>
</p></li>
<li>Flip the whole cluster with probability <span class="MATH"><img width="14" height="16" align="BOTTOM" border="0" src="./The Wolff Algorithm_files/img17.gif" alt="$1$"></span>, then loop back to
 step&nbsp;<span class="MATH"><img width="14" height="16" align="BOTTOM" border="0" src="./The Wolff Algorithm_files/img17.gif" alt="$1$"></span>, in order to build and flip a new cluster.

<p>
</p></li>
</ol>

<p>
Note that in steps&nbsp;<span class="MATH"><img width="14" height="16" align="BOTTOM" border="0" src="./The Wolff Algorithm_files/img45.gif" alt="$2$"></span> and&nbsp;<span class="MATH"><img width="14" height="16" align="BOTTOM" border="0" src="./The Wolff Algorithm_files/img44.gif" alt="$3$"></span>, since only <span class="MATH"><img width="24" height="35" align="MIDDLE" border="0" src="./The Wolff Algorithm_files/img39.gif" alt="$\ell_{+}$"></span> links can be
 activated, the argument of the exponential is negative and thus
 <!-- MATH
 $\exp(-2\beta\psi_{-}\psi_{+})$
 -->
<span class="MATH"><img width="131" height="37" align="MIDDLE" border="0" src="./The Wolff Algorithm_files/img46.gif" alt="$\exp(-2\beta\psi_{-}\psi_{+})$"></span> is a number in the interval <span class="MATH"><img width="46" height="37" align="MIDDLE" border="0" src="./The Wolff Algorithm_files/img20.gif" alt="$(0,1)$"></span>.
 Therefore, so is the probability <!-- MATH
 $p_{+}=1-\exp(-2\beta\psi_{-}\psi_{+})$
 -->
<span class="MATH"><img width="209" height="37" align="MIDDLE" border="0" src="./The Wolff Algorithm_files/img42.gif" alt="$p_{+}=1-\exp(-2\beta\psi_{-}\psi_{+})$"></span>.
 Note also that during the construction of the cluster a certain site may
 be approached by the growing cluster from two or more different
 directions, along different links. If that site does not get linked to
 the cluster at the first trial, it might still get linked at a later
 trial. The algorithm implies that the same link is never tried more than
 once for activation, but a single site my be tried more than once for
 linking to the cluster, if it has more than one link able to be
 activated. Finally, observe that during construction it might happen that
 two sites already included in the cluster are connected by a link that
 has not yet been tried. That link will in fact never be tried by the
 algorithm, and may be considered as automatically activated, that is,
 they can simply be activated with probability <span class="MATH"><img width="14" height="16" align="BOTTOM" border="0" src="./The Wolff Algorithm_files/img17.gif" alt="$1$"></span> at the end of the
 construction. A simple cluster that could result from the algorithm is
 shown in figure&nbsp;<a href="http://latt.if.usp.br/technical-pages/twawesab/Text.html/node1.html#cluster-periodic">2</a>, with its sites and activated
 links, which are shown in a thicker solid line.

</p><p>
Let us now show that this algorithm satisfied the condition of detailed
 balance. In order to do this, given a certain cluster, we must calculate
 the probability that it will be built and flipped. We will denote the
 cluster by <span class="MATH"><img width="16" height="16" align="BOTTOM" border="0" src="./The Wolff Algorithm_files/img47.gif" alt="${\cal C}$"></span> and the boundary of the cluster, that is, the set of
 links that connect the cluster with sites outside the cluster, by <!-- MATH
 ${\partial\cal C}$
 -->
<span class="MATH"><img width="27" height="17" align="BOTTOM" border="0" src="./The Wolff Algorithm_files/img48.gif" alt="${\partial\cal C}$"></span>.
 In figure&nbsp;<a href="http://latt.if.usp.br/technical-pages/twawesab/Text.html/node1.html#large-cluster">3</a> one can see a larger lattice with a cluster
 that could have been built by the algorithm, as well as its boundary,
 illustrated by the thick dotted line which crosses all the links that
 connect the cluster to sites outside the cluster. Since the probability
 of flipping a cluster is <span class="MATH"><img width="14" height="16" align="BOTTOM" border="0" src="./The Wolff Algorithm_files/img17.gif" alt="$1$"></span>, once it has been built, we must simply
 calculate the total probability of building a certain given cluster. The
 process of building the cluster might start at any of its sites, so we
 start the calculation with the probability that one of the sites of the
 cluster will be chosen in step&nbsp;<span class="MATH"><img width="14" height="16" align="BOTTOM" border="0" src="./The Wolff Algorithm_files/img17.gif" alt="$1$"></span> of the algorithm. Let us call this
 probability <span class="MATH"><img width="19" height="33" align="MIDDLE" border="0" src="./The Wolff Algorithm_files/img49.gif" alt="$p_{i}$"></span>, and there is no need to further elaborate on it.

</p><p>
Irrespective of where the construction starts, the probability that the
 given cluster will be built is the product of the probabilities that each
 one of its internal links will be activated, times the product of the
 probabilities that each one of the links of its borders will <em>not</em> be
 activated. Now, all the internal links are <span class="MATH"><img width="24" height="35" align="MIDDLE" border="0" src="./The Wolff Algorithm_files/img39.gif" alt="$\ell_{+}$"></span> links, so the
 probability that they will be activated is given by

</p><p>
<br></p><p></p>
<div align="CENTER" class="mathdisplay">
<!-- MATH
 \begin{displaymath}
\prod_{\ell_{+}\in{\cal C}}p_{+}.
\end{displaymath}
 -->

<img width="60" height="56" border="0" src="./The Wolff Algorithm_files/img50.gif" alt="\begin{displaymath}
\prod_{\ell_{+}\in{\cal C}}p_{+}.
\end{displaymath}">
</div>
<br clear="ALL">
<p></p>

<p>
For the <span class="MATH"><img width="24" height="35" align="MIDDLE" border="0" src="./The Wolff Algorithm_files/img39.gif" alt="$\ell_{+}$"></span> links in the border of the cluster <em>not</em> to be
 activated we have the probability

</p><p>
<br></p><p></p>
<div align="CENTER" class="mathdisplay">
<!-- MATH
 \begin{displaymath}
\prod_{\ell_{+}\in{\partial\cal C}}q_{+},
\end{displaymath}
 -->

<img width="66" height="56" border="0" src="./The Wolff Algorithm_files/img51.gif" alt="\begin{displaymath}
\prod_{\ell_{+}\in{\partial\cal C}}q_{+},
\end{displaymath}">
</div>
<br clear="ALL">
<p></p>

<p>
where <!-- MATH
 $q_{+}=1-p_{+}=\exp(-2\beta\psi_{-}\psi_{+})$
 -->
<span class="MATH"><img width="254" height="37" align="MIDDLE" border="0" src="./The Wolff Algorithm_files/img52.gif" alt="$q_{+}=1-p_{+}=\exp(-2\beta\psi_{-}\psi_{+})$"></span> is the complementary
 probability to <span class="MATH"><img width="25" height="33" align="MIDDLE" border="0" src="./The Wolff Algorithm_files/img43.gif" alt="$p_{+}$"></span>. Since the probability for the <span class="MATH"><img width="24" height="35" align="MIDDLE" border="0" src="./The Wolff Algorithm_files/img40.gif" alt="$\ell_{-}$"></span> links at
 the border not to be activated is <span class="MATH"><img width="14" height="16" align="BOTTOM" border="0" src="./The Wolff Algorithm_files/img17.gif" alt="$1$"></span>, this product is the complete
 probability for the construction of the boundary. We have therefore the
 complete probability for the construction of the cluster, and hence the
 complete probability for the update of the configuration,

</p><p>
<br></p><p></p>
<div align="CENTER" class="mathdisplay">
<!-- MATH
 \begin{displaymath}
W[C\rightarrow C']=p_{i}\left(\prod_{\ell_{+}\in{\cal C}}p_{+}\right)
\left(\prod_{\ell_{+}\in{\partial\cal C}}q_{+}\right).
\end{displaymath}
 -->

<img width="333" height="75" border="0" src="./The Wolff Algorithm_files/img53.gif" alt="\begin{displaymath}
W[C\rightarrow C&#39;]=p_{i}\left(\prod_{\ell_{+}\in{\cal C}}p_{+}\right)
\left(\prod_{\ell_{+}\in{\partial\cal C}}q_{+}\right).
\end{displaymath}">
</div>
<br clear="ALL">
<p></p>

<p>
Next we must consider the probability for the reversed update. Since the
 same set of sites that makes up the cluster <span class="MATH"><img width="16" height="16" align="BOTTOM" border="0" src="./The Wolff Algorithm_files/img47.gif" alt="${\cal C}$"></span> in the configuration <span class="MATH"><img width="19" height="16" align="BOTTOM" border="0" src="./The Wolff Algorithm_files/img3.gif" alt="$C$"></span>
 also makes up the flipped cluster <span class="MATH"><img width="20" height="17" align="BOTTOM" border="0" src="./The Wolff Algorithm_files/img54.gif" alt="${\cal C}&#39;$"></span> in the configuration <span class="MATH"><img width="24" height="17" align="BOTTOM" border="0" src="./The Wolff Algorithm_files/img8.gif" alt="$C&#39;$"></span>, it is
 clear that the probability <span class="MATH"><img width="19" height="33" align="MIDDLE" border="0" src="./The Wolff Algorithm_files/img49.gif" alt="$p_{i}$"></span> is the same in either case. Now,
 repeating the argument used for the cluster <span class="MATH"><img width="16" height="16" align="BOTTOM" border="0" src="./The Wolff Algorithm_files/img47.gif" alt="${\cal C}$"></span> we get for the
 probability that the cluster <span class="MATH"><img width="20" height="17" align="BOTTOM" border="0" src="./The Wolff Algorithm_files/img54.gif" alt="${\cal C}&#39;$"></span> will be built

</p><p>
<br></p><p></p>
<div align="CENTER" class="mathdisplay">
<!-- MATH
 \begin{displaymath}
W[C'\rightarrow C]=p_{i}\left(\prod_{\ell_{+}\in{\cal C}'}p_{+}\right)
\left(\prod_{\ell_{+}\in{\partial\cal C}'}q_{+}\right).
\end{displaymath}
 -->

<img width="341" height="75" border="0" src="./The Wolff Algorithm_files/img55.gif" alt="\begin{displaymath}
W[C&#39;\rightarrow C]=p_{i}\left(\prod_{\ell_{+}\in{\cal C}&#39;}p_...
...right)
\left(\prod_{\ell_{+}\in{\partial\cal C}&#39;}q_{+}\right).
\end{displaymath}">
</div>
<br clear="ALL">
<p></p>

<p>
Observe now that when we flip the fields certain mappings between links
 take place. When we go from the cluster <span class="MATH"><img width="16" height="16" align="BOTTOM" border="0" src="./The Wolff Algorithm_files/img47.gif" alt="${\cal C}$"></span> to the flipped cluster
 <span class="MATH"><img width="20" height="17" align="BOTTOM" border="0" src="./The Wolff Algorithm_files/img54.gif" alt="${\cal C}&#39;$"></span>, we can see that all the internal <span class="MATH"><img width="24" height="35" align="MIDDLE" border="0" src="./The Wolff Algorithm_files/img39.gif" alt="$\ell_{+}$"></span> links of <span class="MATH"><img width="16" height="16" align="BOTTOM" border="0" src="./The Wolff Algorithm_files/img47.gif" alt="${\cal C}$"></span> become
 internal <span class="MATH"><img width="24" height="35" align="MIDDLE" border="0" src="./The Wolff Algorithm_files/img39.gif" alt="$\ell_{+}$"></span> links of <span class="MATH"><img width="20" height="17" align="BOTTOM" border="0" src="./The Wolff Algorithm_files/img54.gif" alt="${\cal C}&#39;$"></span>, since the fields at both ends of each
 link get flipped and hence their product does not change sign. This means
 that the first products that appears in the two formulas above are equal,
 and therefore that we may write the ratio of the two probabilities as

</p><p>
<br></p><p></p>
<div align="CENTER" class="mathdisplay">
<!-- MATH
 \begin{displaymath}
\frac{W[C\rightarrow C']}{W[C'\rightarrow C]}
=\frac{\prod_{\ell_{+}\in{\partial\cal C}}q_{+}}{\prod_{\ell_{+}\in{\partial\cal C}'}q_{+}}.
\end{displaymath}
 -->

<img width="216" height="59" border="0" src="./The Wolff Algorithm_files/img56.gif" alt="\begin{displaymath}
\frac{W[C\rightarrow C&#39;]}{W[C&#39;\rightarrow C]}
=\frac{\prod_{...
...tial\cal C}}q_{+}}{\prod_{\ell_{+}\in{\partial\cal C}&#39;}q_{+}}.
\end{displaymath}">
</div>
<br clear="ALL">
<p></p>

<p>
For the links at the border, however, we have that the <span class="MATH"><img width="24" height="35" align="MIDDLE" border="0" src="./The Wolff Algorithm_files/img39.gif" alt="$\ell_{+}$"></span> links
 of <!-- MATH
 ${\partial\cal C}$
 -->
<span class="MATH"><img width="27" height="17" align="BOTTOM" border="0" src="./The Wolff Algorithm_files/img48.gif" alt="${\partial\cal C}$"></span> become the <span class="MATH"><img width="24" height="35" align="MIDDLE" border="0" src="./The Wolff Algorithm_files/img40.gif" alt="$\ell_{-}$"></span> links of <!-- MATH
 ${\partial\cal C}'$
 -->
<span class="MATH"><img width="31" height="19" align="BOTTOM" border="0" src="./The Wolff Algorithm_files/img57.gif" alt="${\partial\cal C}&#39;$"></span>, and that the <span class="MATH"><img width="24" height="35" align="MIDDLE" border="0" src="./The Wolff Algorithm_files/img40.gif" alt="$\ell_{-}$"></span>
 links of <!-- MATH
 ${\partial\cal C}$
 -->
<span class="MATH"><img width="27" height="17" align="BOTTOM" border="0" src="./The Wolff Algorithm_files/img48.gif" alt="${\partial\cal C}$"></span> become the <span class="MATH"><img width="24" height="35" align="MIDDLE" border="0" src="./The Wolff Algorithm_files/img39.gif" alt="$\ell_{+}$"></span> links of <!-- MATH
 ${\partial\cal C}'$
 -->
<span class="MATH"><img width="31" height="19" align="BOTTOM" border="0" src="./The Wolff Algorithm_files/img57.gif" alt="${\partial\cal C}&#39;$"></span>, since for these
 links only the field at one end gets flipped and therefore the sign of
 the product changes. In addition to this, the term of the action
 corresponding to each link changes sign, so that the factor <span class="MATH"><img width="24" height="33" align="MIDDLE" border="0" src="./The Wolff Algorithm_files/img58.gif" alt="$q_{+}$"></span> gets
 mapped to <span class="MATH"><img width="43" height="37" align="MIDDLE" border="0" src="./The Wolff Algorithm_files/img59.gif" alt="$1/q_{+}$"></span>. If we write the ratio above in terms of the action
 terms,

</p><p>
<br></p><p></p>
<div align="CENTER" class="mathdisplay">
<!-- MATH
 \begin{displaymath}
\frac{W[C\rightarrow C']}{W[C'\rightarrow C]}
=\frac{\prod_{\ell_{+}\in{\partial\cal C}}\exp(-2\beta\psi_{-}\psi_{+})}
{\prod_{\ell_{+}\in{\partial\cal C}'}\exp(-2\beta\psi_{-}\psi_{+})},
\end{displaymath}
 -->

<img width="322" height="59" border="0" src="./The Wolff Algorithm_files/img60.gif" alt="\begin{displaymath}
\frac{W[C\rightarrow C&#39;]}{W[C&#39;\rightarrow C]}
=\frac{\prod_{...
..._{\ell_{+}\in{\partial\cal C}&#39;}\exp(-2\beta\psi_{-}\psi_{+})},
\end{displaymath}">
</div>
<br clear="ALL">
<p></p>

<p>
we see that we can decompose each one of the two products in two parts,

</p><p>
<br></p><p></p>
<div align="CENTER" class="mathdisplay">
<!-- MATH
 \begin{displaymath}
\frac{W[C\rightarrow C']}{W[C'\rightarrow C]}=
\frac{\prod_{\ell_{+}\in{\partial\cal C}}\exp(-\beta\psi_{-}\psi_{+})}
{\prod_{\ell_{+}\in{\partial\cal C}'}\exp(-\beta\psi_{-}\psi_{+})}\;
\frac{\prod_{\ell_{+}\in{\partial\cal C}}\exp(-\beta\psi_{-}\psi_{+})}
{\prod_{\ell_{+}\in{\partial\cal C}'}\exp(-\beta\psi_{-}\psi_{+})}.
\end{displaymath}
 -->

<img width="504" height="59" border="0" src="./The Wolff Algorithm_files/img61.gif" alt="\begin{displaymath}
\frac{W[C\rightarrow C&#39;]}{W[C&#39;\rightarrow C]}=
\frac{\prod_{...
...d_{\ell_{+}\in{\partial\cal C}&#39;}\exp(-\beta\psi_{-}\psi_{+})}.
\end{displaymath}">
</div>
<br clear="ALL">
<p></p>

<p>
Now, due to the mappings of the boundary links which we just discussed,
 we have that the following two equations hold,

</p><p>

</p><p></p>
<div align="CENTER" class="mathdisplay">
<!-- MATH
 \begin{eqnarray*}
\prod_{\ell_{+}\in{\partial\cal C}}\exp(-\beta\psi_{-}\psi_{+}) & = &
 \prod_{\ell_{-}\in{\partial\cal C}'}\exp(\beta\psi_{-}\psi_{+}), \\
 \prod_{\ell_{+}\in{\partial\cal C}'}\exp(-\beta\psi_{-}\psi_{+}) & = &
 \prod_{\ell_{-}\in{\partial\cal C}}\exp(\beta\psi_{-}\psi_{+}),
\end{eqnarray*}
 -->
<img width="363" height="112" border="0" src="./The Wolff Algorithm_files/img62.gif" alt="\begin{eqnarray*}
\prod_{\ell_{+}\in{\partial\cal C}}\exp(-\beta\psi_{-}\psi_{+}...
... \prod_{\ell_{-}\in{\partial\cal C}}\exp(\beta\psi_{-}\psi_{+}),
\end{eqnarray*}"></div>
<br clear="ALL"><p></p>
<br clear="ALL"><p></p>

<p>
so that the ratio of updating probabilities may be written as

</p><p>

</p><p></p>
<div align="CENTER" class="mathdisplay">
<!-- MATH
 \begin{eqnarray*}
\frac{W[C\rightarrow C']}{W[C'\rightarrow C]} & = &
\frac{\prod_{\ell_{+}\in{\partial\cal C}}\exp(-\beta\psi_{-}\psi_{+})}
{\prod_{\ell_{+}\in{\partial\cal C}'}\exp(-\beta\psi_{-}\psi_{+})}\;
\frac{\prod_{\ell_{-}\in{\partial\cal C}'}\exp(\beta\psi_{-}\psi_{+})}
{\prod_{\ell_{-}\in{\partial\cal C}}\exp(\beta\psi_{-}\psi_{+})} \\& = &
\frac{\prod_{\ell_{+}\in{\partial\cal C}'}\exp(\beta\psi_{-}\psi_{+})}
{\prod_{\ell_{+}\in{\partial\cal C}}\exp(\beta\psi_{-}\psi_{+})}\;
\frac{\prod_{\ell_{-}\in{\partial\cal C}'}\exp(\beta\psi_{-}\psi_{+})}
{\prod_{\ell_{-}\in{\partial\cal C}}\exp(\beta\psi_{-}\psi_{+})}.
\end{eqnarray*}
 -->
<img width="505" height="117" border="0" src="./The Wolff Algorithm_files/img63.gif" alt="\begin{eqnarray*}
\frac{W[C\rightarrow C&#39;]}{W[C&#39;\rightarrow C]} &amp; = &amp;
\frac{\pro...
...\prod_{\ell_{-}\in{\partial\cal C}}\exp(\beta\psi_{-}\psi_{+})}.
\end{eqnarray*}"></div>
<br clear="ALL"><p></p>
<br clear="ALL"><p></p>

<p>
Note that in this way we have completed the set of boundary links in both
 the numerator and the denominator, so that we may write

</p><p>
<br></p><p></p>
<div align="CENTER" class="mathdisplay">
<!-- MATH
 \begin{displaymath}
\frac{W[C\rightarrow C']}{W[C'\rightarrow C]}
=\frac{\prod_{\ell\in{\partial\cal C}'}\exp(\beta\psi_{-}\psi_{+})}
{\prod_{\ell\in{\partial\cal C}}\exp(\beta\psi_{-}\psi_{+})}
=\frac{\exp(\sum_{\ell\in{\partial\cal C}'}\beta\psi_{-}\psi_{+})}
{\exp(\sum_{\ell\in{\partial\cal C}}\beta\psi_{-}\psi_{+})}.
\end{displaymath}
 -->

<img width="476" height="54" border="0" src="./The Wolff Algorithm_files/img64.gif" alt="\begin{displaymath}
\frac{W[C\rightarrow C&#39;]}{W[C&#39;\rightarrow C]}
=\frac{\prod_{...
...}
{\exp(\sum_{\ell\in{\partial\cal C}}\beta\psi_{-}\psi_{+})}.
\end{displaymath}">
</div>
<br clear="ALL">
<p></p>

<p>
What we see here in the argument of the two exponentials in the last form
 of this equation is the negative of the part of the action that
 corresponds to the boundary links, which we may denote by
 <!-- MATH
 $S_{B}=-\sum_{\ell\in{\partial\cal C}}\beta\psi_{-}\psi_{+}$
 -->
<span class="MATH"><img width="184" height="37" align="MIDDLE" border="0" src="./The Wolff Algorithm_files/img65.gif" alt="$S_{B}=-\sum_{\ell\in{\partial\cal C}}\beta\psi_{-}\psi_{+}$"></span>. We may therefore write
 the ratio of the two updating probabilities as

</p><p>
<br></p><p></p>
<div align="CENTER" class="mathdisplay">
<!-- MATH
 \begin{displaymath}
\frac{W[C\rightarrow C']}{W[C'\rightarrow C]}
=\frac{\exp(-S_{B}[C'])}{\exp(-S_{B}[C'])}=\exp(-\Delta S_{B}).
\end{displaymath}
 -->

<img width="362" height="52" border="0" src="./The Wolff Algorithm_files/img66.gif" alt="\begin{displaymath}
\frac{W[C\rightarrow C&#39;]}{W[C&#39;\rightarrow C]}
=\frac{\exp(-S_{B}[C&#39;])}{\exp(-S_{B}[C&#39;])}=\exp(-\Delta S_{B}).
\end{displaymath}">
</div>
<br clear="ALL">
<p></p>

<p>
Since in the flipping of a cluster the parts of the action corresponding
 to links that are either completely internal to the cluster or completely
 external to it do not change at all, the only variation of the action is
 that due to the boundary links, which means that <!-- MATH
 $\Delta S=\Delta S_{B}$
 -->
<span class="MATH"><img width="97" height="35" align="MIDDLE" border="0" src="./The Wolff Algorithm_files/img67.gif" alt="$\Delta S=\Delta S_{B}$"></span>,
 and hence we get the final relation

</p><p>
<br></p><p></p>
<div align="CENTER" class="mathdisplay">
<!-- MATH
 \begin{displaymath}
\frac{W[C\rightarrow C']}{W[C'\rightarrow C]}=\exp(-\Delta S),
\end{displaymath}
 -->

<img width="212" height="52" border="0" src="./The Wolff Algorithm_files/img68.gif" alt="\begin{displaymath}
\frac{W[C\rightarrow C&#39;]}{W[C&#39;\rightarrow C]}=\exp(-\Delta S),
\end{displaymath}">
</div>
<br clear="ALL">
<p></p>

<p>
which is indeed the condition of detailed balance, as we set out to show.
 Please note how important it is for this demonstration the fact that the
 update of a cluster changes the action exclusively at the boundary links
 of the cluster, and not at its bulk, that is, at its interior sites and
 links.

</p><p>

</p><div class="navigation"><hr>
<!--Navigation Panel-->
<a name="tex2html26" href="http://latt.if.usp.br/technical-pages/twawesab/Text.html/node2.html">
<img width="37" height="24" align="BOTTOM" border="0" alt="next" src="./The Wolff Algorithm_files/next.gif"></a> 
<a name="tex2html24" href="http://latt.if.usp.br/technical-pages/twawesab/Text.html/Text.html">
<img width="26" height="24" align="BOTTOM" border="0" alt="up" src="./The Wolff Algorithm_files/up.gif"></a> 
<a name="tex2html18" href="http://latt.if.usp.br/technical-pages/twawesab/Text.html/Text.html">
<img width="63" height="24" align="BOTTOM" border="0" alt="previous" src="./The Wolff Algorithm_files/prev.gif"></a>   
<br>
<b> Next:</b> <a name="tex2html27" href="http://latt.if.usp.br/technical-pages/twawesab/Text.html/node2.html">Arbitrary External Sources</a>
<b> Up:</b> <a name="tex2html25" href="http://latt.if.usp.br/technical-pages/twawesab/Text.html/Text.html">The Wolff Algorithm with</a>
<b> Previous:</b> <a name="tex2html19" href="http://latt.if.usp.br/technical-pages/twawesab/Text.html/Text.html">The Wolff Algorithm with</a></div>
<!--End of Navigation Panel-->



</body><div class="b-freemium-editor" style="display: none;"><div class="b-freemium-editor-back"></div><iframe class="gr-freemium-ifr"></iframe></div><div class="gr-context gr-dict gr-context-loader gr-dict-freemium" style="display: none;"><span class="gr-triangle"></span><div class="gr-placeholder"></div><a href="http://www.grammarly.com/?utm_source=dict&utm_medium=link&utm_campaign=chrome_plg" target="_blank" class="gr-hint-settings"></a><strong class="gr-title"></strong><div class="gr-dict-content"></div></div></html>