(function(){this.SessionModal={},this.SessionModal.pubSub=_.extend({},Backbone.Events)}).call(this),function(){var t,o={}.hasOwnProperty,r=function(t,r){function e(){this.constructor=t}for(var n in r)o.call(r,n)&&(t[n]=r[n]);return e.prototype=r.prototype,t.prototype=new e,t.__super__=r.prototype,t};SessionModal.Base=function(o){function e(){return t=e.__super__.constructor.apply(this,arguments)}return r(e,o),e.prototype.initialize=function(){return this.notifier=new c.Server.Notification("sutd")},e.prototype.render=function(){return $("#overlay_background").css({opacity:".6"}),$("#overlay_background").show(),this.$el.fadeIn()},e.prototype.close=function(){return this.$el.fadeOut(),$("#overlay_background").fadeOut()},e}(Backbone.View)}.call(this),function(){var t,o={}.hasOwnProperty,r=function(t,r){function e(){this.constructor=t}for(var n in r)o.call(r,n)&&(t[n]=r[n]);return e.prototype=r.prototype,t.prototype=new e,t.__super__=r.prototype,t};SessionModal.CoauthorSignup=function(o){function e(){return t=e.__super__.constructor.apply(this,arguments)}return r(e,o),e.prototype.events={"click .btn-email, .coauthor-verify-close-email-form":"toggleEmailForm"},e.prototype.initialize=function(){return SessionModal.pubSub.on("signup:errors",this.show_registration_errors,this)},e.prototype.toggleEmailForm=function(){return this.$(".js-email-form-toggle").toggleClass("hidden"),this.$("#user_first_name").val()&&this.$("#user_last_name").val()?this.$("#user_password").focus():this.$("#user_first_name").focus()},e.prototype.show_registration_errors=function(t){var o,r;return this.$("#validation-errors").show(),this.$(".inline-error").remove(),this.$(".has-error").removeClass("has-error"),o={},_.each(t,function(t){var r,e;return e=t[0],r=t[1],o[e]=r}),r=this.$("#error-list"),_.each(o,function(t,o){var e,n;return e="<li class='inline-error'>"+t+"</li>",n=$("input[name='"+o+"']"),n.closest(".form-group").addClass("has-error"),n.length>0?r.append(e):void 0})},e}(Backbone.View)}.call(this),function(){var t,o={}.hasOwnProperty,r=function(t,r){function e(){this.constructor=t}for(var n in r)o.call(r,n)&&(t[n]=r[n]);return e.prototype=r.prototype,t.prototype=new e,t.__super__=r.prototype,t};SessionModal.DownloadWork=function(o){function e(){return t=e.__super__.constructor.apply(this,arguments)}return r(e,o),e.prototype.el="#download-modal",e.prototype.events={"click .close-modal":"close","click .doc_download":"download_clicked"},e.prototype.initialize=function(){return e.__super__.initialize.apply(this,arguments),SessionModal.pubSub.on("download_work:show",this.render,this)},e.prototype.render=function(){return e.__super__.render.apply(this,arguments),this._truncateTitle(),this.notifier.notify({event_type:"popover_show",auvid:$auvid})},e.prototype.close=function(){return e.__super__.close.apply(this,arguments),this.notifier.notify({event_type:"popover_close",auvid:$auvid})},e.prototype.download_clicked=function(){return this.$el.fadeOut(),this.notifier.notify({event_type:"sutd_modal_download_btn_clicked",auvid:$auvid}),SessionModal.pubSub.trigger("signup:show")},e.prototype._truncateTitle=function(){return $(".js-download-modal-work-title-truncation").trunk8({lines:3,tooltip:!1})},e}(SessionModal.Base)}.call(this),function(){var t,o={}.hasOwnProperty,r=function(t,r){function e(){this.constructor=t}for(var n in r)o.call(r,n)&&(t[n]=r[n]);return e.prototype=r.prototype,t.prototype=new e,t.__super__=r.prototype,t};SessionModal.Signup=function(o){function e(){return t=e.__super__.constructor.apply(this,arguments)}return r(e,o),e.prototype.el="#signup-modal",e.prototype.events={"click .close-signup-modal":"close","click .email-signup-button":"toggle_email_form","click .close-email-form":"toggle_email_form","click #terms-link":"terms_clicked"},e.prototype.initialize=function(){return e.__super__.initialize.apply(this,arguments),SessionModal.pubSub.on("signup:show",this.render,this),SessionModal.pubSub.on("signup:errors",this.show_registration_errors,this)},e.prototype.close=function(){return e.__super__.close.apply(this,arguments),this.notifier.notify({event_type:"download_closed",auvid:$auvid})},e.prototype.toggle_email_form=function(){return this.$(".js-email-form-toggle").toggleClass("hidden")},e.prototype.terms_clicked=function(t){return t.preventDefault(),this.notifier.notify({event_type:"terms",auvid:$auvid}),window.location.href=t.currentTarget.href},e.prototype.show_registration_errors=function(t){var o,r;return this.$("#signup-modal-validation-errors").show(),this.$(".inline-error").remove(),this.$(".has-error").removeClass("has-error"),o={},_.each(t,function(t){var r,e;return e=t[0],r=t[1],o[e]=r}),r=this.$("#signup-modal-error-list"),_.each(o,function(t,o){var e,n;return e="<li class='inline-error'>"+t+"</li>",n=$("input[name='"+o+"']"),n.closest(".form-group").addClass("has-error"),n.length>0?r.append(e):void 0}),this.notifier.notify({event_type:"validation_failure",error:JSON.stringify(t),auvid:$auvid})},e}(SessionModal.Base)}.call(this);